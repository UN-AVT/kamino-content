---
title: "Kamino"
output:
  bookdown::gitbook: default
documentclass: book
date: "`r Sys.Date()`"
---

```{r, include=FALSE}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE)
options(scipen=999)  # turn-off scientific notation like 1e+48

library(tidyverse)
library(DBI)
library(RSQLite)

library(kableExtra)

library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("Inconsolata", "inconsolata")
# turn on showtext
showtext_auto()

```

INGEST  

# Mental Health Survey
## Ingest a SQLite database

```{r, out.width="60%", fig.align="center", fig.cap="Photo by Dan Meyers on Unsplash"}

masthead <- "assets/dan-meyers-unsplash.jpg"
knitr::include_graphics(masthead, dpi=72)

```

> Mental health affects every aspect of your life. It's not just this neat little issue you can put into a box....\
--- Shannon Purser\

***


### Accessing the database
#### db_connection

In order to explore the data within the Mental Health database, we can first open a db connection and list all its tables. 

```{r, echo=TRUE, message=FALSE, warning=FALSE, class.source='fold-show'}

db <- dbDriver("SQLite")
conn <- dbConnect(db,'archetypes/mental-health/mental_health.sqlite')
df <- as.data.frame(dbListTables(conn))

```

Now that we know this database presents the tables __Answer__, __Question__ and __Survey__, we can access each one of them separately.

Since this is a survey, we will read __Question__ table first. Then, __Answer__ and __Survey__ tables will follow.

### Explore
#### Question table

```{r, echo=TRUE, message=FALSE, warning=FALSE, class.source='fold-hide'}

df1 <- dbReadTable(conn, 'Question')

```


### Explore
#### Answer table


```{r, echo=TRUE, message=FALSE, warning=FALSE,class.source='fold-hide'}

df2 <- dbReadTable(conn, 'Answer')

```


### Explore
#### Survey table

```{r, echo=TRUE, message=FALSE, warning=FALSE, class.source='fold-hide'}

df3 <- dbReadTable(conn, 'Survey')

```


### Close
#### the database connection.


```{r, echo=TRUE, message=FALSE, warning=FALSE, class.source='fold-show'}

dbDisconnect(conn)

```


### References
#### citations for narrative and data sources


* Data: Open Sourcing Mental Illness Ltd., OSMI Mental Health in Tech, https://osmihelp.org/research

<pre>
@misc{osmi_research,
  author = {OSMI},
  title = {Research :: Open Sourcing Mental Illness - Changing how we talk about mental health in the tech community - Stronger Than Fear},
  url = {https://osmihelp.org/research},
  urldate = {2021-02-24},
  organization = {osmihelp.org}
}
</pre>
