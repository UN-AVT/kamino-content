---
pagetitle: "Google Trending Searches on Data Science"
output:
  bookdown::gitbook: default
documentclass: book
date: "`r Sys.Date()`"
---

```{r, include=FALSE}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE)
options(scipen=999)  # turn-off scientific notation like 1e+48

library(tidyverse)
library(ggiraph)
library(kableExtra)

library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("Inconsolata", "inconsolata")
# turn on showtext
showtext_auto()

```

WRANGLERS  

# Google Trending Searches on "Data Science"
## Format Date


```{r, out.width="60%", fig.align="center", fig.cap="Photo by Luke Chesser on Unsplash"}

masthead <- "assets/trend-unsplash.jpg"
knitr::include_graphics(masthead, dpi=72)

```

<div class="figure-text"> Trends Visualization</div>

> To be a consistent winner means preparing not just one day, one month or even one year - but for a lifetime...\
--- Bill Rodgers\

***

### Load data


```{r load-data, echo=TRUE, message=FALSE, warning=FALSE,class.source = 'fold-hide'} 

df <- read.csv('archetypes/google-trend-on-data-science.csv')

```



### Convert character format into date format 

#### Let's focus on the <span style="color: #8000FF;font-weight:bold">Time</span> column. 

If only the __date__ (not the time) portion of the data is needed, then use as.Date to convert the characters into date format.

```{r convert date, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'} 

df_1 <- df
df_1$date <- as.Date(df$Time)

```


#### On the other hand, if __time__ is important to us, then add the time into the date format as <span style="font-weight:bold">%Y-%m-%dT%H:%M:%S</span>. You may set the default system time zone to convert the date and time. In our case, it only records in hours.

```{r method: convert time, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'} 

df_2 <- df
df_2$Time <-as.POSIXct(df_2$Time, format = "%Y-%m-%dT%H",tz=Sys.timezone())

```


### Quarter
#### Use this method to create a <span style="color: #2E2EFE;font-weight:bold">Quarter</span> column which categorizes each record into each quarter as per <span style="color: #8000FF;font-weight:bold">Time</span>.


```{r method: qtr,  message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'} 

df_3 <- df
df_3$Quarter <-quarters(df_2$Time)

```

### Year
#### Use this method to create a <span style="color: #2E2EFE;font-weight:bold">Year</span> column which captures the year of <span style="color: #8000FF;font-weight:bold">Time</span>.


```{r method: yr, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'} 

df_4 <- df_2
df_4$Year <- format(df_2$Time,format="%Y")

```

### Year_Month

#### Use this method to create a <span style="color: #2E2EFE;font-weight:bold">Year_Month</span> column which captures only the combination year and month of <span style="color: #8000FF;font-weight:bold">Time</span>.

```{r method: ym, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'} 

df_5 <- df_2
df_5$Year_Month <-format(df_2$Time,format="%Y-%m")

```


### Month
#### Use this method to create a <span style="color: #2E2EFE;font-weight:bold">Month</span> column (Numeric or Abbreviation format) which captures only the month of <span style="color: #8000FF;font-weight:bold">Time</span>.


```{r method: m, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'} 

df_6 <- df_2
df_6$Month_Num <-format(df_2$Time,format="%m")
df_6$Month_ABR <-format(df_2$Time,format="%b")

```

### Month_Day
#### Likewise, use this method to create a <span style="color: #2E2EFE;font-weight:bold">Month_Day</span> column (Numeric or Name format) which captures the month-and-day (or day-and-month) combination of <span style="color: #8000FF;font-weight:bold">Time</span>.


```{r method: md, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'} 

df_7 <- df_2
df_7$MM_DD_Num <- format(df_2$Time,format="%m-%d")
df_7$DD_MM_Name <- format(df_2$Time,format="%d %B")

```

### Plot an example

```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-hide', fig.width= 1920/72, fig.height = 1080/72, out.width = "100%"}

df <- read.csv('archetypes/historical-trend-on-data-science.csv')
df_1 <- add_column(df,date=paste0(df$Month,'-01'))
df_1$quarter<-quarters(as.Date(df_1$date))
df_1$year<-format(as.Date(df_1$date),format="%Y")

df_2 <- df_1 %>% group_by(quarter,year) %>% summarise(sum_number=sum(data.science...Worldwide.))%>% filter(between(year, as.numeric("2013"), as.numeric("2020")))
rownames(df_2) <- NULL
df_3 <- df_1 %>% group_by(year) %>% summarise(sum_number=sum(data.science...Worldwide.))%>%filter(year!=2021)
rownames(df_3) <- NULL
v1<-ggplot(data=df_3, aes(x=year, y=sum_number, group=1))+
  geom_line(color='#2E2EFE',size=1.5,alpha=0.3)+
  geom_point(color='#2E2EFE',size=1.8)+
  theme_minimal()+labs(
    x='Year',
    y='Search Frequency'
  )

v2<-ggplot(data=df_2, aes(x=quarter, y=sum_number, group=year)) +
  geom_step(aes(color=year))+
  geom_point(aes(color=year))+
  theme_minimal()+labs(
    x='Quarter',
    y='Search Frequency'
  )

girafe(ggobj = v1, width_svg = 1280/72, height_svg = 720/72,
       options = list(opts_sizing(rescale = TRUE, width = 1.0))
)

girafe(ggobj = v2, width_svg = 1280/72, height_svg = 720/72,
       options = list(opts_sizing(rescale = TRUE, width = 1.0))
)

```


# References
## The citations and data sources used for this case

The data source was from <a href="https://trends.google.com/trends/trendingsearches/daily?geo=US" target="_blank">Google Trending Searches on "Data Science"</a>.

<pre>
@misc{googletrends_google,
  author = {Google Trends},
  title = {Google Trends},
  url = {https://trends.google.com/trends/explore?date=today%201-m&q=Data%20Science},
  urldate = {2021-05-28},
  organization = {Google Trends}
}
</pre>
