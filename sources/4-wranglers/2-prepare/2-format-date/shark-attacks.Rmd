---
pagetitle: "Global Shark Attack"
output:
  bookdown::gitbook: default
documentclass: book
date: "`r Sys.Date()`"
---

```{r, include=FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, dev = "svg" )
options(scipen=999)  # turn-off scientific notation like 1e+48

library(lubridate)
library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("Inconsolata", "inconsolata")
# turn on showtext
showtext_auto()
 
```

WRANGLERS  

# Global Shark Attack
## Format date

```{r, out.width="80%", fig.align="center",out.height="80%", fig.cap="Photo by Marcelo Cidrack on Unsplash"}

masthead <- "assets/marcelo-cidrack-unsplash.jpg"
knitr::include_graphics(masthead, dpi=72)

```

> Instead of ignoring the problem or pretending that we can put up nets and protect everyone from sharks, what is needed is a public education campaign to teach people how to co-exist with sharks.\
--- Lewis Levine, M.D\

***

Humans are not on the menu of sharks. Sharks bite humans out of curiosity or to defend themselves. By understanding when and why shark attacks occur, it is possible to lessen the likelihood of these incidents.Humans are familiar with predators found on land; we know enough not to walk into a pride of lions. Similarly, we need to recognize and avoid potentially dangerous situations in the water.



### Ingest the data

```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide'}

url_root <- "https://raw.githubusercontent.com/UN-AVT/kamino-source/main/sources/0-shared/data/"
url_file <- "shark-attacks/GSAF5.csv"
url <- paste0(url_root, url_file)

df <- read.csv(url, header = TRUE, stringsAsFactors = FALSE)
df

```

Let's use only the first 5 columns and check the internal structure of our dataset.

```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide'}

new_df <- df[,c(1:5)]
str(new_df)

```

We can see that the date column is in character format and we need to convert this into date format before starting the analysis.


### Wrangle
Format date column using <kbd>as.Date()</kbd> 

```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide'}

#Add a new date column in date format
new_df$date <- as.Date(new_df$Date,format = "%d-%b-%y")
head(new_df)

```

If format is not explicitly given, __as.Date__ (by default) assumes the string to be in either "%Y-%m-%d" or "%Y/%m/%d" format.


To see the attack counts per month, we can get the month from __date__ column using the <kbd>format()</kbd> function.

```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide'}

# Add a new month column
new_df$month <- format(new_df$date, format="%B")
table(new_df$month)

```

We can see from the above table that __July__ is the month with the most shark attacks. 


Another method to convert into date format:
\
Using <kbd>lubridate</kbd> package, <kbd>parse_date_time()</kbd> function.


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide'}

new_df2 <- df[,c(1:5)]

#adding a date column using lubridate
new_df2$date <- parse_date_time(new_df2$Date, orders="dmy")
head(new_df2$date)

```

Note that __parse_date_time__ always assigns the "UTC" time zone. "UTC" stands for "Coordinated Universal Time". It creates a __POSIXct__ object, which we have to force into a __Date__ object if we want to make sure it behaves as a date.


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide'}

class(new_df2$date)

new_df2$date <- as.Date(new_df2$date)
class(new_df2$date)

```


### References
#### Citations and data sources

* Narration : Shark Attack File, [GO](https://www.sharkattackfile.net/whystudy.htm){target="_blank"}
* Data: 30DayChartChallenge, [GO](https://github.com/luisfrein/-30DayChartChallenge/tree/master/8.Animal){target="_blank"}
