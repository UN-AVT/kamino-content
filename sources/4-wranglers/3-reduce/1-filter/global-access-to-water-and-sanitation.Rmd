---
pagetitle: "Global Access to Water and Sanitation"
output: 
  html_document:
    theme: lumen
    css: "../../../z-assemblers/assets/styles/content.css"
    df_print: paged
    mathjax: NULL
    code_folding: show
    include:
      in_header: ["../../../z-assemblers/fragments/google-analytics.html", "../../../z-assemblers/fragments/header.html"]
      after_body: "../../../z-assemblers/fragments/footer.html"
    self_contained: false
    lib_dir: "vendor"
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE)
options(scipen=999)  # turn-off scientific notation like 1e+48

# Clear environment and memory
rm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.
gc() #free up memory and report the memory usage.

library(tidyverse)
library(ggiraph)

library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("Inconsolata", "inconsolata")
# turn on showtext
showtext_auto()

```

<div class="activity">
WRANGLERS  
</div>


# Global Access to Water and Sanitation 
## Filter

```{r, out.width="60%", fig.align="center", fig.cap="Photo by Gallery DS on Unsplash"}

masthead <- "assets/gallery-ds-X_tEarX6svc-unsplash.jpg"
knitr::include_graphics(masthead, dpi=72)

```


> Obviously, we all look at things through the filter of our own experiences....\
--- Malcolm-Jamal Warner\

***

### Ingest

```{r load-data, echo=TRUE, message=FALSE, warning=FALSE,class.source = 'fold-hide'}

df <- read.csv('./archetypes/access-to-water-and-sanitation/access-to-water-and-sanitation.csv', header = TRUE, stringsAsFactors = FALSE)
df

```

### Wrangle
#### Where equal

Filter where rows equal to __Africa__ in the <span style="background: #E0ECF8; font-weight:bold">Continent</span> column. 

```{r method: where equal, echo=TRUE, message=FALSE}

df_1 <- df %>% filter(Continent=="Africa")
df_1

```


#### Where not equal

Taking only African countries into consideration, let's say we want to eliminate, for some reason, <span style="font-weight:bold">Angola</span> from <span style="background: #E0F8EC;font-weight:bold">Country</span> from this data


```{r, message=FALSE, echo=TRUE, warning=FALSE}

df_2 <- df %>% filter((Continent=="Africa") & !(Country=="Angola"))
df_2

```


#### Where greater than 

Filter dataset where <span style="background: #D0A9F5;font-weight:bold">Population</span> is greater than <span style="font-weight:bold">50,000</span>.

```{r, message=FALSE, echo=TRUE,warning=FALSE}

df_6 <- df_2%>%  filter(Population > 50000)
df_6

```


#### Where less than  

Filter dataset where <span style="background: #D0A9F5;font-weight:bold">Population</span> is less than <span style="font-weight:bold">50,000</span>.


```{r method: where less than, message=FALSE, echo=TRUE,warning=FALSE}

df_8 <- df_2 %>%  filter(Population < 50000)
df_8

```


#### Where between date

First, let's convert the column <span style="background: #F78181;font-weight:bold">Date</span> into date format.


```{r, message=FALSE, echo=TRUE,warning=FALSE}

df_9 <- df
df_9$Date<-as.Date(df_9$Date, tryFormats = c("%Y-%m-%d"),optional = FALSE)
df_9

```


Filter dataset where <span style="background: #F78181;font-weight:bold">Date</span> is between  <span style="font-weight:bold">2010-2015</span>:


```{r method: where between date, echo=TRUE, message=FALSE, warning=FALSE}

df_10 <- df_9%>% filter(between(Date, as.Date("2010-01-01"), as.Date("2015-01-01")))
df_10

```


#### Where before date

Filter rows where <span style="background: #F78181;font-weight:bold">Date</span> is before <span style="font-weight:bold">2000</span>.


```{r method: where before date, message=FALSE, echo=TRUE,warning=FALSE}

df_11 <- df_9 %>% filter(Date < as.Date("2000-01-01"))
df_11

```


#### Where after date

Filter rows where <span style="background: #F78181;font-weight:bold">Date</span> is after <span style="font-weight:bold">2010</span> for the countries with <span style="background: #A9F5F2;font-weight:bold">No access to water</span> for a population that is bigger than <span style="background: #F5D0A9;font-weight:bold">75,000</span>.


```{r method: where after date, message=FALSE, echo=TRUE,warning=FALSE}

df_12 <- df_9%>% filter(Date > as.Date("2010-01-01") & (Metric=="No access to water") & (Population > 75000))
df_12

```


#### Based on regular expression (regex)

Filter the dataset where <span style="background: #FE9A2E;font-weight:bold">Continent</span> name starts with <span style="font-weight:bold">S</span>:


```{r method: regex, message=FALSE, echo=TRUE,warning=FALSE}

df_13 <- df %>% filter(str_detect(Continent, "^S"))
df_13

```


### References
#### The citations and data sources used for this case

* Narrative and Data Sources: Global Clean Water and Sanitation, Unicef

<pre>
@misc{unicef_sdg,
  author = {UNICEF},
  title = {SDG Goal 6: Clean Water and Sanitation},
  url = {https://data.unicef.org/sdgs/goal-6-clean-water-sanitation/#:~:text=Goal%206%20aims%20to%20ensure%20availability%20and%20sustainable},
  urldate = {2021-03-18},
  organization = {UNICEF DATA}
}
</pre>


```{r, echo=FALSE, eval=FALSE, message=FALSE, warning=FALSE, class.source='fold-hide'}

# eval = FALSE as default; run manually as chunk
# PUSH TO PRODUCTION
source("../../../z-scripts/create_production_output.R", local = knitr::knit_global())

```


```{js, message=FALSE, warning=FALSE, echo=FALSE}

// Must be included to position footer
$(function() {
  $('.main-container').after($('.footer'));
})

```

