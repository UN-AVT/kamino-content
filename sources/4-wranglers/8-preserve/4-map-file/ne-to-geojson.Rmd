---
pagetitle: "Kamino"
output:
  bookdown::gitbook: default
documentclass: book
date: "`r Sys.Date()`"
---

```{r, include = FALSE, results = "hide"}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE)
options(scipen = 999) ## To disable scientific notation

library(tidyverse)
library(sf)
library(gdalUtilities)
library(geojsonio)
library(ggplot2)
library(ggiraph)

```



```{r, message = FALSE, warning = FALSE, echo = FALSE, results = "hide"}

# Load map sources
# Shape files and data
# ++++++++++++++++++++
# borders, adm0
# borders, adm1
# borders, adm2
# ++++++++++++++++++++

# Borders
#badm0 <- st_read("map-sources/borders/ssd_admbnda_adm0_imwg_nbs_20180817/ssd_admbnda_adm0_imwg_nbs_20180817.shp")

state <- st_read("archetypes/south-sudan/geojson/ss-state.geojson")
county <- st_read("archetypes/south-sudan/geojson/ss-county.geojson")
abeyi <- st_read("archetypes/south-sudan/geojson/ss-abeyi.geojson")

#head(as.data.frame(adm0))
head(as.data.frame(state))
head(as.data.frame(county))
head(as.data.frame(abeyi))

```


```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.width = 12, fig.height = 12, out.width = "100%"}

geojson_write(state, file = "archetypes/south-sudan/topojson/ss-state.geojson")

drivers <- st_drivers(what = "vector")
drivers_write <- filter(drivers, write == TRUE)
drivers_write

st_write(state, "archetypes/south-sudan/topojson/ss-state.geojson", driver = "GeoJSON")
# ogr2ogr(f="TopoJSON", "archetypes/south-sudan/topojson/ss-state.geojson", "archetypes/south-sudan/topojson/ss-state.topojson")

test <- st_read("archetypes/south-sudan/topojson/ss-state.geojson")
head(as.data.frame(test))

```



```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.width = 12, fig.height = 12, out.width = "100%"}

# theme parameters
theme_opts <- theme(
  legend.position = "none",
  legend.title = element_blank(),
  axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  axis.title = element_blank(),
  panel.grid = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  # panel.background = element_blank(),
  panel.background = element_rect(fill = "#ffffff"),
  panel.border = element_blank(),
  # plot.background = element_blank(),
  plot.background = element_rect(fill = "#ffffff")
)

transparent_fill <- rgb(0, 0, 0, max = 255, alpha = 0, names = "transparent")

# In order of layer placement top -> down
v1 = ggplot() +
  geom_sf(data = state, color="#333333", fill = transparent_fill, size=1.0) +
  #geom_sf(data = county, color="#333333", fill = transparent_fill, size=0.5) +
  #geom_sf(data = abeyi, color="#333333", fill = transparent_fill, size=0.5, linetype = "dashed") +
  scale_x_continuous() +
  scale_y_continuous() +
  coord_sf() +
  theme_bw() +
  labs(x = NULL, # Longitude
       y = NULL, # Latitude
       title = NULL, 
       subtitle = NULL) +
  theme_opts

# v1

girafe( ggobj = v1, width_svg = 12, height_svg = 8, options = list( opts_sizing(rescale = TRUE, width = 0.9) ))

```


```{r}

library(rnaturalearth)

map <- ne_countries(scale = "large", returnclass = "sf")

geojson_write(map, file = "archetypes/world/ne_countries_large_1.geojson")

st_write(map, "archetypes/world/ne_countries_large_2.geojson", driver = "GeoJSON")

test1 <- st_read("archetypes/world/ne_countries_large_1.geojson")

head(as.data.frame(test1))

test2 <- st_read("archetypes/world/ne_countries_large_2.geojson")

head(as.data.frame(test2))

```




```{r, message = FALSE, warning = FALSE, echo = FALSE, include = FALSE }

# Save output to file

ggsave(filename = "assets/1-ssd-base-1.svg", plot = v1, width=10.5, height=8)

```


