---
pagetitle: "Ygot Drug Syndicate"
output:
  html_document:
    theme: lumen
    css: "../../../z-assemblers/assets/styles/content.css"
    df_print: paged
    mathjax: NULL
    code_folding: show
    include:
      in_header: ["../../../z-assemblers/fragments/google-analytics.html", "../../../z-assemblers/fragments/header.html"]
      after_body: "../../../z-assemblers/fragments/footer.html"
    self_contained: false
    lib_dir: "vendor"
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE)
options(scipen=999)  # turn-off scientific notation like 1e+48

# Clear environment and memory
rm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.
gc() #free up memory and report the memory usage.

library(tidyverse)
library(ggraph)
library(igraph)
library(tidygraph)
library(graphlayouts)
library(ggrepel)
library(ggiraph)

library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("Inconsolata", "inconsolata")
# turn on showtext
showtext_auto()

```

<div class="activity">
GRAPHS  
</div>

# Ygot Drug Syndicate
## link analysis 


```{r, out.width = "60%", fig.align = 'center', fig.cap="Photo by Jr Korpa on Unsplash"}

#masthead <- "assets/jr-korpa-unsplash.jpg"
#knitr::include_graphics(masthead, dpi=72)

```


> It's clear that there's a lot of human wood out there for this coronavirus forest fire to burn...\
--- Michael Thomas Osterholm\

***

CEBU CITY, Philippines — She was dubbed as Consolacion’s drug queen when police found out that she was the source of 28 kilograms of shabu, worth P190.4 million. Jocelyn Encila, known to many as "Joy", served as a key operator at the heart of the Rustico Ygot Drug Syndicate. Encila and Ygot were ex-lovers, but their relationship endured as Encila helped Ygot run a drug syndicate from the confines of his prison cell at the New Bilibid Prison (NBP) in Muntinlupa City. But aside from Ygot, Encila allegedly also has other connections that helped the drug group in their illegal activities. Some of these individuals happened to be her alleged lovers, including policeman, another inmate from NBP, and officers from the Philippine Coast Guard (PCG) and the Philippine National Police (PNP). Encila's relationship with Jake Arglo Garces would prove deadly, as he is detained in NBP for murder charges, convicted for killing a "macho dancer" he suspected Encila was attracted to. Encila's involvement and illegal activities were discovered by authorities fter police raided her house. 

### Ingest
#### the tree of mutations


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-hide'}

df <- read.csv("archetypes/ygot-drug-syndicate/ygot-drug-syndicate.csv", header = TRUE, stringsAsFactors = FALSE)
df

```


### Wrangle
#### create graph structure


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-show'}

# transform to graph data structure
df_graph <- graph_from_data_frame( df )
df_graph_directed <- graph_from_data_frame( df, directed = TRUE )
df_graph_undirected <- graph_from_data_frame( df, directed = FALSE )

# to view results as data frame
df_graph_view <-  get.data.frame(df_graph, what = "both" ) # as.data.frame(get.edgelist(df_graph))
# df_graph_view

```


### Analytics
#### compute layouts


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source ='fold-hide', fig.width=1920/72, fig.height=1080/72, out.width="100%"}

##################
# igraph layouts #
##################

# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'bipartite')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'circle')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'dh')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'drl')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'fr')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'gem')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'graphopt')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'grid')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'kk')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'lgl')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'mds')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'nicely')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'sphere')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'star')
# layout <- create_layout(df_graph, layout = 'igraph', algorithm = 'sugiyama')

##################
# ggraph layouts #
##################

# layout <- create_layout(df_graph_undirected, layout = 'backbone')

# layout <- betweenness(df_graph_directed)
# layout <- closeness(df_graph_directed)
# layout <- create_layout(df_graph_undirected, layout = 'centrality', centrality = centrality_bc)

# layout <- create_layout(df_graph_directed, layout = 'circlepack')
# layout <- create_layout(df_graph_directed, layout = 'dendrogram')
# layout <- create_layout(df_graph, layout = 'eigen', type = "laplacian", eigenvector = "smallest")

layout <- create_layout(df_graph, layout = 'focus', focus = 1)

# layout <- create_layout(df_graph, layout = 'hive', axis = friends, sort.by = degree)

# layout <- create_layout(df_graph, layout = 'linear')
# layout <- create_layout(df_graph, layout = 'matrix')
# layout <- create_layout(df_graph_directed, layout = 'partition')

# pmds_pivots <- 2
# layout <- create_layout(df_graph, layout = 'pmds', pivots = pmds_pivots)

# layout <- create_layout(df_graph, layout = 'stress')
# layout <- create_layout(df_graph_directed, layout = 'partition', circular = TRUE)
# layout <- create_layout(df_graph_directed, layout = 'treemap')

# df_unrooted <- df_graph_undirected %>%  activate(edges) %>%  mutate(length = runif(n()))
# layout <- create_layout(df_graph_undirected, layout = 'unrooted' )

```


### Plot
#### dendrogram


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide', fig.align='center', out.width="100%"}

theme_opts <- theme(
    text = element_text(family = "inconsolata"), 
    legend.position='none'
)

v1 <- ggraph(df_graph, layout = layout) + 
  geom_edge_link(aes(label = label), angle_calc = 'along', label_dodge = unit(2.5, 'mm'), size = 5, family = "inconsolata") +
  geom_node_point(size=4) +
  #geom_node_text( aes(label=name), repel = TRUE, vjust = 0.0, hjust = 0.5, nudge_y = 0.1, size = 6, family = "inconsolata") +
  geom_text_repel(aes(x = x, y = y, label = name), vjust = 0.5, hjust = 0.5, point.size = 10, direction = "both", size = 6, family = "inconsolata") +
  coord_cartesian(clip = 'off') + 
  theme_void() +
  theme_opts

girafe(ggobj = v1, width_svg = 16, height_svg = 14,
       options = list(opts_sizing(rescale = TRUE, width = 1.0))
)

# pg <- ggplot_build(v1)
# pg$data[[2]]
# pg$data[[3]]

```


### References
#### citations for narrative and data sources

* Narrative: https://cebudailynews.inquirer.net/221416/love-and-drugs-encilas-life-as-consolacions-drug-queen


```{r, echo=FALSE, eval=FALSE, message=FALSE, warning=FALSE, class.source='fold-hide'}

# eval = FALSE as default; run manually as chunk
# PUSH TO PRODUCTION
source("../../../z-scripts/create_production_output.R", local = knitr::knit_global())

```


```{js, message=FALSE, warning=FALSE, echo=FALSE}

// Must be included to position footer
$(function() {
  $('.main-container').after($('.footer'));
})

```

