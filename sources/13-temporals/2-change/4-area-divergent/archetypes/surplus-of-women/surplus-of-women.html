<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="format-detection" content="telephone=no">
<meta name="msapplication-tap-highlight" content="no">
<meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width">
<title>HARVESTER</title>

<script type="text/javascript" src="../../tests/0-dev/chance/chance.js"></script>

<!-- HARVEST TOOLKIT LIBS CORE -->
<script type="text/javascript" src="/libs/h_tk_vendor/cash.min.js"></script>
<script type="text/javascript" src="../../h_tk/workflow/defs/q.js"></script>

<!-- FUNCTIONAL -->
<script type="text/javascript" src="/libs/h_tk_vendor/sugar.js"></script>

<!-- LAYOUTERS -->
<script type="text/javascript" src="/libs/h_tk_vendor/d3/d3.min.js"></script>


<!-- RENDERERS -->
<!-- 2D / 2.5D -->
<script type="text/javascript" src="/libs/h_tk_vendor/renderers/paper/paper-full.js"></script>

<style>
    /*
    font-family: 'Fira Code', monospace;
    font-family: 'Fira Sans Condensed', sans-serif;
    font-family: 'Fira Sans Extra Condensed', sans-serif;
    font-family: 'Fira Mono', monospace;
    font-family: 'Fira Sans', sans-serif;
    */
    body {
        font-family: 'Fira Sans Condensed', sans-serif;
        font-size: 14px;
        font-weight: 400;
        line-height: 18px;
    }

    ::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #1CABE2;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
        background: #046D95;
    }

    .section-container {
        width: 100%;
        height: 100%;
        margin: 0 auto;
        padding: 0;
        padding-left: 20px;
        padding-right: 20px;
        outline: none;
        overflow: auto;
    }

    /* VIEW CONTAINER */
    .view-container {
        max-width: calc(100vw - 55px);
        width: calc(100vw - 55px);
        max-height: calc(100vh - 25px);
        height: calc(100vh - 25px);
        margin-top: 10px;
        margin-left: 5px;
        margin-right: 5px;
        margin-bottom: 5px;
        padding: 5px;
        outline: none;
        overflow: hidden;
        background-color: #FFFFFF;
        border: 3px solid #FFFFFF;
    }
      /*Title*/
      h2{text-align:center}
      h4{text-align:center}
</style>

<!-- Need when running in Electron mode -->
</head>

<body>

    <!-- VISUALIZATION SECTION -->
    <div id="vis-section" class="section-container">
    <h2>Surplus of women due to World Wars fades in Germany, but higher life expectancy still causes a plus of elderly women</h2>
<h4>Difference between number of men and women for each age in 1950 (red) and 2018(blue), in Germany.</h4>
        <canvas id="vis-content" class="view-container"></canvas>
    </div>



    <!-- UI -->


    <!-- HARVEST -->
    <script type="text/javascript" src="../../h_tk/main.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/harvest-core.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/min/h-tk-ingest.min.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/collections.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/wranglers-group.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/wranglers-clean.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/wranglers-filter.js"></script>
    <script type="text/javascript" src="../../h_tk/wranglers/defs/filter/where.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/wranglers-format-number.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/wranglers-format-string.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/analytics-summarize.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/wranglers-profile.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/wranglers-transform.js"></script>
    <script type="text/javascript" src="../../h_tk/analytics/defs/summarize/group-count.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/min/h-tk-analytics.min.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/mappers.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/makers-common.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/makers-2d.js"></script>
    <script type="text/javascript" src="/libs/h_tk_dist/unmin/makers-assemblers-2d.js"></script>

    <!-- LAYOUTS -->
    <script type="text/javascript" src="../../h_tk/layouts/chart/2d/area/area-overlay-ms-xn-yn.js"></script>

    <!-- OUTPUTS -->
    <script type="text/javascript" src="../../h_tk/output/defs/exporters.js"></script>
    <script type="text/javascript" src="../../h_tk/output/data-file.js"></script>
    <!-- TASKERS -->
    <script type="text/javascript" src="../../h_tk/workflow/tasker.js"></script>

    <script>

        ////////////////////////////////////////////////////////////
        /////////////////////// Load File //////////////////////////
        ////////////////////////////////////////////////////////////

        var DATA_FILE =  './data.csv';
        
        /**
         * Describe this function...
         */
        function loadData() {
            // Ingest a comma delimited file as array of objects.
            let data = H.Df.csv(DATA_FILE);
            data.then(function (result) {
                data = result;
            });
            return data;
        }

        function runClean(data) {

let clean = H.Clean.replace_value(data, '1950', 'null', 0);
return clean;
}

function wideToLong(data) {

let long = H.Transforms.wide_to_long(data, ['1950', '2018'], ['1950', '2018']);
return long;
}


function assignColor(data) {
let case_colors = ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2']

const cmap = [{
    'label': '1950',
    'color': case_colors[1]
}, {
    'label': '2018',
    'color': case_colors[4]
}];
let coloredData = H.Color.categorical(data, 'MEASURE', cmap);
return coloredData;
}

function runView(data) {
let vspec = {
    el: "vis-content",
    fit: true,
    show_points: false
};
let fmap = {
    x_field: 'age',
    value_field: 'VALUE',
    series_field: 'MEASURE',
    color_field: 'COLOR'
}
let view = H.Chart.Twod.area_overlay_ms_xn_yn(data, fmap, vspec);
}

let taskSet = [loadData, runClean, wideToLong, assignColor, runView];
taskChain = H.Tasker.sequence(taskSet);
    </script>

</body>

</html>