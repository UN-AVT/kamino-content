---
pagetitle: "Kamino"
output: 
  html_document:
    theme: lumen
    css: ["../../../z-assemblers/assets/styles/content/kamino.css", "../../../z-assemblers/assets/icons/line-awesome/css/line-awesome.css"]
    df_print: paged
    mathjax: NULL
    code_folding: show
    include:
      in_header: "../../../z-assemblers/fragments/header.html"
      after_body: "../../../z-assemblers/fragments/footer.html"
    #self_contained: false
    #lib_dir: libs
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE)
options(scipen=999)  # turn-off scientific notation like 1e+48

library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggbeeswarm)
library(ggiraph)

library(showtext)

# Font used for views
font_add_google(name = "Open Sans", family = "Open Sans")
showtext_auto()

library(knitcitations)
library(bibtex)

```

<div class="activity">
TEMPORAL  
</div>

# Beeswarm Plot
## P.S. Swarming is a honey bee colony's natural means of reproduction.

> Language is the road map of a culture. It tells you where its people come from and where they are going...\
--- Rita Mae Brown\

***

# Language Diversity Index for Canada
## Census data for CSD and CMA levels


```{r}

canada_ldi_df <- read.csv('./archetypes/language-diversity-index/canada-ldi.csv', header = TRUE)
# canada_ldi_df

# This is what we'll focus
canada_ldi_df_select <- canada_ldi_df %>% select('CSD_NAME', 'CMA_NAME', 'CSD_LDI', 'CSD_POPULATION', 'CSD_AREA_SQKM')
canada_ldi_df_select

country_ldi_df <- read.csv('./archetypes/language-diversity-index/country-ldi-2017-enriched.csv', header = TRUE)
# country_ldi_df

```

# Pick the bees and their features
## Mapping the visual variables

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Mapping of visual variables
movv <- data.frame("x" = 'CSD_LDI', "y" = 'CMA_NAME', "group" = 'CMA_NAME', 'size' = 'CSD_POPULATION', 'color' = 'CSD_AREA_SQKM')
movv

```


# Beeswarm
## With default parameters

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=8, fig.width=12}

# Beeswarm Parameters
# size
# groupOnX=FALSE
# priority: descending, density, random

cma_csd_plot <- ggplot() + 
                geom_beeswarm(data = canada_ldi_df, 
                  aes(x = CSD_LDI, y = CMA_NAME, group = CMA_NAME, size = CSD_POPULATION, color = CSD_AREA_SQKM), alpha = 0.90, groupOnX = FALSE) + 
                scale_size_continuous(guide = FALSE) + 
                scale_color_gradient(low = "#AF7AC5", high = "#E74C3C")   +
                scale_x_continuous(limits = c(0,1)) +
                theme_minimal() +
                theme(legend.position='none') +
                labs(caption = "Showing ten largest CMAs by population size and their constituent CSDs") + xlab(NULL) + ylab(NULL)
  
girafe(ggobj = cma_csd_plot, width_svg = 13.0, height_svg = 6.0,
       options = list(opts_sizing(rescale = TRUE, width = 1)))

```

# Show the swarm
## with priority settings

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=8, fig.width=12}

# Beeswarm Parameters
# size
# groupOnX=FALSE
# priority: descending, density, random

beeswarm_side_plot <- ggplot() + 
                geom_beeswarm(data = canada_ldi_df, 
                  aes(x = CSD_LDI, y = CMA_NAME, group = CMA_NAME, size = CSD_POPULATION, color = CSD_AREA_SQKM), alpha = 0.90,
                  groupOnX = FALSE, 
                  priority='descending') +
                scale_size_continuous(guide = FALSE) + 
                scale_color_gradient(low = "#AF7AC5", high = "#E74C3C") +
                scale_x_continuous(limits = c(0,1)) +
                theme_minimal() +
                theme(legend.position='none') +
                labs(caption = "Showing ten largest CMAs by population size and their constituent CSDs") + xlab(NULL) + ylab(NULL)
  
girafe(ggobj = beeswarm_side_plot, width_svg = 13.0, height_svg = 6.0,
       options = list(opts_sizing(rescale = TRUE, width = 1)))

```


# Quasirandom
## It's quasi and it's random!


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=8, fig.width=12}

# quasirandom parameters
# varwidth = boolean
# method: tukey, tukeyDense, frowney, smiley, pseudorandom

quasi_plot <- ggplot() + 
                geom_quasirandom(data = canada_ldi_df, 
                  aes(x = CSD_LDI, y = CMA_NAME, group = CMA_NAME, size = CSD_POPULATION, color = CSD_AREA_SQKM), alpha = 0.90, 
                  groupOnX = FALSE,
                  varwidth = TRUE,
                  method = "tukey") + # tukeyDense, frowney, smiley, pseudorandom
                scale_size_continuous(guide = FALSE) + 
                scale_color_gradient(low = "#AF7AC5", high = "#E74C3C") +
                scale_x_continuous(limits = c(0,1)) +
                theme_minimal() +
                theme(legend.position='none') +
                labs(caption = "Showing ten largest CMAs by population size and their constituent CSDs") + xlab(NULL) + ylab(NULL)
  
girafe(ggobj = quasi_plot, width_svg = 13.0, height_svg = 6.0,
       options = list(opts_sizing(rescale = TRUE, width = 1)))

```


# Region and countries
## Canada compared to the rest of the world

```{r, echo=FALSE, message=FALSE, warning=FALSE}

country_ldi_df

```


# Pick the bees and their features
## Mapping the visual variables


```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Mapping of visual variables
movv <- data.frame("x" = 'LDI', "y" = 'REGION', "group" = 'REGION', 'size' = 'SP_POP_TOTL_2017', 'color' = 'SP_POP_TOTL_2017')
movv

```


# Region and Countries
## Wow! Papua New Guinea, Cameroon, Vanuatu...


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=7, fig.width=12}

country_beeswarm_plot <- ggplot() + 
                geom_beeswarm(data = country_ldi_df, 
                  aes(x = LDI, 
                      y = REGION, 
                      group = REGION, 
                      size = SP_POP_TOTL_2017, 
                      color = SP_POP_TOTL_2017), 
                  alpha = 0.90,
                  groupOnX = FALSE) + 
                scale_size_continuous(guide = FALSE) + 
                scale_color_gradient(low = "#AF7AC5", high = "#E74C3C") +
                scale_x_continuous(limits = c(0,1)) +
                theme_minimal() +
                theme(legend.position='none') +
                labs(caption = "Showing Language Diversity Index by Region and Country") + xlab(NULL) + ylab(NULL)
  
# country_beeswarm_plot

girafe(ggobj = country_beeswarm_plot, width_svg = 13.0, height_svg = 5.0,
       options = list(opts_sizing(rescale = TRUE, width = 1)))

```



# References
## The citations and data sources used for this case can be found on

Data Source Canada: Statistics Canada, via the CensusMapper and cancensus (R wrapper).
Based on the work of <a href="https://www.dshkol.com/2017/language-diversity-in-canada" target="_blank"> Dmitry Shkolnik. </a> 

Data <a href="https://en.wikipedia.org/wiki/Linguistic_diversity_index" target="_blank">Source World </a>  



```{r generateBibliography, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}

 cleanbib()
 read.bibtex(file = "citations/language-diversity-index.bib")

```




```{js, message=FALSE, warning=FALSE, echo=FALSE}

// Must be included to position footer
$(function() {
  $('.main-container').after($('.footer'));
})

showtext_auto(FALSE) 

```


