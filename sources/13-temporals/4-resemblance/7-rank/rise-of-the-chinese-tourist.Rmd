---
pagetitle: "Rise of Chinese Tourists in Canada"
output:
  html_document:
    theme: lumen
    css: "../../../z-assemblers/assets/styles/content.css"
    df_print: paged
    mathjax: NULL
    code_folding: show
    include:
      in_header: ["../../../z-assemblers/fragments/google-analytics.html", "../../../z-assemblers/fragments/header.html"]
      after_body: "../../../z-assemblers/fragments/footer.html"
    self_contained: false
    lib_dir: "vendor"
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo = FALSE)
options(scipen = 999) ## To disable scientific notation

# Clear environment and memory
rm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.
gc() #free up memrory and report the memory usage.

library(tidyverse)
library(ggalt)
require(ggrepel)
library(scales)
library(wesanderson)
library(ggiraph)

library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("Inconsolata", "inconsolata")
# turn on showtext
showtext_auto()

```

# The rise of the Chinese tourist in Canada
## Rank Chart a.k.a. Bump

```{r, out.width = "60%", fig.align = 'center', fig.cap="Photo by Luke Porter on Unsplash"}

masthead <- "assets/luke-porter-unsplash.jpg"
knitr::include_graphics(masthead, dpi=72)

```

> Once you have traveled, the voyage never ends. The mind can never break off from the journey...\
--- Pat Conroy\

***

### Load data [Ingest]

```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-hide'}

rank_df = read.csv("archetypes/chinese-tourist/the-rise-of-the-chinese-tourist.csv", header = TRUE, stringsAsFactors = TRUE)  # read text file 
rank_df

```





```{r, message=FALSE, warning=FALSE, echo=FALSE, class.source = 'fold-hide'}
## Prepare data [Wrangle] -->
# Filter for year and continent
#rank_df <- rank_df %>%
#  filter(YEAR %in% c(1990, 1995, 2000, 2005, 2010, 2015, 2018))
# Create ordered factor for year
#rank_df$YEAR <- factor(rank_df$YEAR, ordered = TRUE, levels = c("1990", "1995", "2000", "2005", "2010", "2015", "2018"))
#rank_df

```


### Plot [ Views / Temporals ]


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-hide',  fig.align='center', out.width="100%"}

plot_specs <- list(  
  theme_bw(),
  theme( plot.margin = unit(c(0,3,0,3), "cm") ),
  # Format tweaks
  # Remove the legend
  theme(legend.position = "none"),
  # Remove the panel border
  theme(panel.border     = element_blank()),
  # Remove just about everything from the y axis
  theme(axis.title.y     = element_blank()),
  theme(axis.text.y      = element_blank()),
  theme(panel.grid.major.x = element_blank()),
  theme(panel.grid.minor.x = element_blank()),
  theme(panel.grid.major.y = element_blank()),
  theme(panel.grid.minor.y = element_blank()),
  # Remove a few things from the x axis and increase font size
  theme(axis.title.x     = element_blank()),
  theme(panel.grid.major.x = element_blank()),
  theme(axis.text.x.top      = element_text(size=12)),
  # Remove x & y tick marks
  theme(axis.ticks       = element_blank()),
  # Format title & subtitle
  theme(plot.title       = element_text(size=14, face = "bold")),
  theme(plot.subtitle    = element_text())
)

x_axis <- c(1990, 1995, 2000, 2005, 2010, 2015, 2018)

discrete_color_palette <- c('#cccccb', '#c22800')

v1 <- ggplot(data = rank_df, aes(x = YEAR, y = RANK, group = COUNTRY)) +
  
  geom_xspline(aes(color=ifelse(((COUNTRY %in% "China")),"Below", "Above")), size = 1.0,
               spline_shape = -.15) +
  geom_text(data = rank_df %>% filter(YEAR == "1990"), 
                  aes(label = paste0(RANK)) , 
                  hjust = "right",
                  nudge_x = -0.2,
                  nudge_y = 0.05, 
                  fontface = "bold", 
                  size = 2.5) +
  geom_point(data = rank_df %>% filter(YEAR == "1990"), 
             aes(fill=ifelse(((COUNTRY %in% "China")),"Below", "Above")), 
             shape = 21, color = "white", size = 2.0, stroke = 1, alpha = 1) +
  geom_text(data = rank_df %>% filter(YEAR == "2018"), 
                  aes(label = paste0(COUNTRY)), 
                  hjust = "left",
                  nudge_x = 0.2,
                  nudge_y = 0.05, 
                  fontface = "bold", 
                  size = 2.5) +
  geom_point(data = rank_df %>% filter(YEAR == "2018"), 
             aes(fill=ifelse(((COUNTRY %in% "China")),"Below", "Above")), 
             shape = 21, color = "white", size = 2.0, stroke = 1, alpha = 1) +
  scale_x_continuous(breaks = x_axis, labels = x_axis, position = "bottom") +
  scale_y_reverse() +
  # Important to remove clipping for long y axis labels
  coord_cartesian(clip = "off") +
  scale_fill_manual(values = discrete_color_palette) +
  scale_color_manual(values = discrete_color_palette) +
  plot_specs +
  labs(
    title = "The rise of the Chinese tourist",
    subtitle = "Top 20 countries of origin for travellers coming to Canada by rank.",
    caption = "source: Statistics Canada"
  )

v1

```



```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-hide'}

ggsave(filename = "assets/the-rise-of-the-chinese-tourist.svg", plot = v1, width=13.33, height=7.5)

```


### References
#### Citations and data sources

* Narrative inspiration: CBC, Why Canada's tourism industry is finally heating up again, [GO](https://www.cbc.ca/news/canada/travel-canada-numbers-1.4682484){target="_blank"}
* Data Sources: Statistics Canada,
[GO](https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=2410000601){target="_blank"}


```{r, echo=FALSE, eval=FALSE, message=FALSE, warning=FALSE, class.source='fold-hide'}

# eval = FALSE as default; run manually as chunk
# PUSH TO PRODUCTION
source("../../../z-scripts/create_production_output.R", local = knitr::knit_global())

```


```{js, message=FALSE, warning=FALSE, echo=FALSE}

// Must be included to position footer
$(function() {
  $('.main-container').after($('.footer'));
})

```


