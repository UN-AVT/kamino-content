---
pagetitle: "The Human Footprint"
output:
  html_document:
    theme: lumen
    css: "../../../z-assemblers/assets/styles/content.css"
    df_print: paged
    mathjax: NULL
    code_folding: show
    include:
      in_header: ["../../../z-assemblers/fragments/google-analytics.html", "../../../z-assemblers/fragments/header.html"]
      after_body: "../../../z-assemblers/fragments/footer.html"
    self_contained: false
    lib_dir: "vendor"
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo = FALSE)
options(scipen = 999) ## To disable scientific notation

# Clear environment and memory
rm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.
gc() #free up memrory and report the memory usage.

library(tidyverse)
library(colorspace)
library(ggforce)
library(ggiraph)

library(showtext)
## Loading Google fonts (https://fonts.google.com/)
font_add_google("Inconsolata", "inconsolata")
# turn on showtext
showtext_auto()

```

<div class="activity">
MAPS  
</div>

# The Human Footprint
## Tilegrid


```{r, out.width = "60%", fig.align = 'center', fig.cap="Photo by Carolina Pimenta on Unsplash"}

masthead <- "assets/carolina-pimenta-unsplash.jpg"
knitr::include_graphics(masthead, dpi=72)

```

> We all leave footprints as we journey through life--make sure yours are worth following...\
--- Bob Teague\

***

### Ingest
#### tile coordinates and measures


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source = 'fold-hide'}

worldtilegrid <- read.csv("archetypes/feeling-climate-change/feeling-climate-change.csv", header = TRUE)
worldtilegrid

```


### View
#### hexagon tiles


```{r, message=FALSE, warning=FALSE, echo=TRUE, class.source='fold-hide', fig.align='center', out.width="100%"}

theme_opts <- theme(
    text = element_text(family = "inconsolata"), 
    plot.title = element_text(color = "black", size = 18, face = "bold", family = "inconsolata"),
    plot.subtitle = element_text(color = "black", size = 16, family = "inconsolata"),
    plot.caption = element_text(color = "#555555", size = 8, family = "inconsolata"),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.border = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank(),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 8),
    legend.position='top'
  )

change_fill_palette <- c(
  "increase" = "#cf7073",
  "low agreement" = "#f8cd8d",
  "limited data" = "#d3dde4"
)

change_color_palette <- c(
  "increase" = darken("#cf7073", 0.15),
  "low agreement" = darken("#f8cd8d", 0.15),
  "limited data" = darken("#d3dde4", 0.15)
)

make_mark <- function(l) {
  case_when(
    l == "high" ~ paste0("\u25cf", "\u25cf", "\u25cf"), # "●●●",
    l == "medium" ~ paste0("\u25cf", "\u25cf"),
    l == "low" ~ paste0("\u25cf"),
    l == "low due to limited evidence" ~ paste0("\u25cb")
  )
}


theta <- 90 * pi/180

v1 <- ggplot(worldtilegrid, aes(x = xcoord, y = ycoord, fill = Observed_Change, group = Region_Code)) +
  geom_regon(aes(x0 = xcoord, y0 = ycoord, sides = 6, angle = theta, r = 0.55, color = Observed_Change), size = 2) +
  geom_text(aes(label = Region_Code), size = 6, color = "black", nudge_y = 0.1, vjust = 0.0, hjust = 0.5, family = "inconsolata", fontface = 2) +
  geom_text(aes(label = make_mark(Confidence_in_Human_Contribution)), size = 6, color = "black", nudge_y = -0.1, vjust = 1.0, hjust = 0.5, family = "inconsolata", fontface = 2) +
  geom_text(data = . %>% filter(Region_Code == "NWN"), 
            aes(x = xcoord, y = ycoord, label = "North America"), size = 6, color = "black", nudge_y = 0.75, vjust = 0.0, hjust = 0.15, family = "inconsolata", fontface = 2) +
  geom_text(data = . %>% filter(Region_Code == "GIC"), 
            aes(x = xcoord, y = ycoord, label = "Europe"), size = 6, color = "black", nudge_x = 1.5, vjust = 0.5, hjust = 0.5, family = "inconsolata", fontface = 2) +
  geom_text(data = . %>% filter(Region_Code == "RFE"), 
            aes(x = xcoord, y = ycoord, label = "Asia"), size = 6, color = "black", nudge_x = 1.0, vjust = 0.5, hjust = 0.0, family = "inconsolata", fontface = 2) +
  geom_text(data = . %>% filter(Region_Code == "SAH"), 
            aes(x = xcoord, y = ycoord, label = "Africa"), size = 6, color = "black", nudge_x = -0.75, vjust = 0.5, hjust = 1.0, family = "inconsolata", fontface = 2) +
  geom_text(data = . %>% filter(Region_Code == "NAU"), 
            aes(x = xcoord, y = ycoord, label = "Oceania"), size = 6, color = "black", nudge_x = -0.75, vjust = 0.5, hjust = 1.0, family = "inconsolata", fontface = 2) +
  geom_text(data = . %>% filter(Region_Code == "SCA"), 
            aes(x = xcoord, y = ycoord, label = "Central\nAmerica"), size = 6, color = "black", nudge_x = -0.75, vjust = 0.5, hjust = 1.0, family = "inconsolata", fontface = 2) +
  geom_text(data = . %>% filter(Region_Code == "SSA"), 
            aes(x = xcoord, y = ycoord, label = "South America"), size = 6, color = "black", nudge_x = 0.75, vjust = 0.5, hjust = 0.0, family = "inconsolata", fontface = 2) +
  #geom_point() +
  scale_y_reverse() +
  scale_fill_manual(values = change_fill_palette) +
  scale_color_manual(values = change_color_palette) +
  coord_equal() +
  labs(title = "The Human Footprint",
       subtitle = "Assessment of observed change and confidence in human contribution to the observed changes",
       y=NULL, x=NULL,
       caption = NULL) +
  theme_bw() +
  theme_opts

girafe(ggobj = v1, width_svg = 16, height_svg = 10,
       options = list(opts_sizing(rescale = TRUE, width = 0.8)))

```





### References
#### citations for narrative and data sources

* Narrative inspiration: The Economist, [GO](https://www.economist.com/graphic-detail/2021/08/09/where-is-climate-change-being-felt-most-acutely){target="_blank"}


```{r, echo=FALSE, eval=FALSE, message=FALSE, warning=FALSE, class.source='fold-hide'}

# eval = FALSE as default; run manually as chunk
# PUSH TO PRODUCTION
source("../../../z-scripts/create_production_output.R", local = knitr::knit_global())

```


```{js, message=FALSE, warning=FALSE, echo=FALSE}

// Must be included to position footer
$(function() {
  $('.main-container').after($('.footer'));
})

```

